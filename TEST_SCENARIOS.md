# テストシナリオと指示方法

## 概要

このドキュメントでは、サンプルサイトに対する境界値テストとフォーム入力テストの観点を整理し、MCPツール（Chrome DevTools MCP、Playwright MCP、Playwright Agent Mode）への具体的な指示方法を示します。

---

## 1. 境界値テスト

### 1.1 データ件数による表示切り替えの境界値

#### テスト観点

| 境界値 | 期待される動作 | 確認項目 |
|--------|--------------|---------|
| **0件** | エンプティメッセージ表示 | ・エンプティメッセージが表示される<br>・テーブルが非表示<br>・ページングが非表示<br>・件数表示が「全 0 件」 |
| **1件** | テーブル表示開始 | ・エンプティメッセージが非表示<br>・テーブルが表示される<br>・ページングが非表示<br>・件数表示が「全 1 件」 |
| **19件** | ページング境界前 | ・テーブルに19行表示<br>・ページングが非表示<br>・全データが1ページ内に表示 |
| **20件** | ページング境界（ちょうど1ページ分） | ・テーブルに20行表示<br>・ページングが非表示<br>・全データが1ページ内に表示 |
| **21件** | ページング境界超え | ・ページングコントロールが表示される<br>・ページ情報が「2 / 2」と表示<br>・現在のページに1件表示（最新データ） |
| **40件** | ちょうど2ページ分 | ・ページ情報が「2 / 2」<br>・2ページ目に20件表示 |
| **41件** | 3ページ目発生 | ・ページ情報が「3 / 3」<br>・3ページ目に1件表示 |

#### MCPツールへの指示例

##### Playwright Agent Modeへの指示

```
【タスク】サンプルサイトの境界値テストを実行してください

対象URL: http://127.0.0.1:5500/sample-site/index.html

以下の境界値パターンでテストケースを生成し、実行してください:

1. 0件の状態
   - エンプティメッセージ「データがありません」が表示されること
   - テーブルが非表示であること
   - ページングが非表示であること

2. 1件追加後の状態
   - エンプティメッセージが非表示になること
   - テーブルが表示されること
   - ページングが非表示のままであること
   - 件数表示が「全 1 件」となること

3. 19件追加後の状態
   - テーブルに19行のデータが表示されること
   - ページングが非表示であること

4. 20件追加後の状態（境界値）
   - テーブルに20行のデータが表示されること
   - ページングが非表示であること
   - これがページング表示の境界であることを確認

5. 21件追加後の状態（境界値超え）
   - ページングコントロールが表示されること
   - ページ情報が「2 / 2」と表示されること
   - 最終ページ（2ページ目）に1件のデータが表示されること
   - 1ページ目に戻ると20件のデータが表示されること

6. 40件と41件の状態
   - 40件: ページ情報が「2 / 2」、2ページ目に20件表示
   - 41件: ページ情報が「3 / 3」、3ページ目に1件表示

各テストケースで以下を確認:
- UI要素の表示/非表示
- 件数表示の正確性
- データの整合性
- ページ遷移の動作

テストコードを生成し、実行結果をレポートしてください。
```

##### Playwright MCPへの指示

```
Playwright MCPを使用して、サンプルサイトの境界値テストを実行してください。

URL: http://127.0.0.1:5500/sample-site/index.html

手順:
1. ページを開く
2. 初期状態（0件）を確認
   - #emptyMessage が表示されていることを確認
   - #tableContainer が非表示であることを確認
   - #pagination が非表示であることを確認

3. データを1件追加
   - #name に「テストユーザー1」を入力
   - #email に「test1@example.com」を入力
   - #age に「25」を入力
   - #submitBtn をクリック

4. 1件後の状態を確認
   - #emptyMessage が非表示になっていることを確認
   - #tableContainer が表示されていることを確認
   - #tableBody tr の数が1であることを確認

5. さらに19件追加（合計20件）
   - ループで19回データを追加

6. 20件の状態を確認
   - #pagination が非表示であることを確認
   - #tableBody tr の数が20であることを確認

7. さらに1件追加（合計21件）

8. 21件の状態を確認
   - #pagination が表示されていることを確認
   - #pageInfo のテキストが「2 / 2」を含むことを確認

各ステップでスクリーンショットを取得してください。
```

##### Chrome DevTools MCPへの指示

```
Chrome DevTools MCPを使用して、境界値テスト時のパフォーマンスを測定してください。

URL: http://127.0.0.1:5500/sample-site/index.html

測定シナリオ:
1. 0件の状態でのパフォーマンス測定
   - ページロード時間
   - DOM要素数
   - メモリ使用量

2. 20件追加後のパフォーマンス測定
   - レンダリング時間
   - DOM要素数の変化
   - メモリ使用量の変化

3. 50件追加後のパフォーマンス測定
   - レンダリング時間
   - DOM要素数の変化
   - メモリ使用量の変化

4. 比較レポート作成
   - 0件 vs 20件 vs 50件
   - パフォーマンスの劣化度合い
   - 境界値でのパフォーマンス変化

各測定でCore Web Vitalsも取得してください。
```

---

## 2. フォーム入力テスト

### 2.1 必須項目のバリデーション

#### テスト観点

| フィールド | バリデーションルール | 境界値 | 異常系 |
|-----------|-------------------|--------|--------|
| **名前** | 必須、最大50文字 | 0文字、1文字、50文字、51文字 | 空文字、51文字以上 |
| **メールアドレス** | 必須、メール形式 | - | 不正な形式（@なし、ドメインなし） |
| **年齢** | 必須、0-150、整数 | -1、0、1、149、150、151 | 負の数、151以上、小数点 |
| **部署** | 任意選択 | - | 未選択（デフォルト値「未設定」） |

#### MCPツールへの指示例

##### Playwright Agent Modeへの指示

```
【タスク】フォーム入力の包括的なバリデーションテストを実行してください

対象URL: http://127.0.0.1:5500/sample-site/index.html

以下のテストケースを生成し、実行してください:

## 1. 名前フィールドのテスト

### 正常系
- 1文字の名前: 「あ」
- 通常の名前: 「山田太郎」
- 最大文字数: 「あ」を50回繰り返し

### 異常系
- 空文字のまま送信
  → エラーメッセージ「名前は必須です」が表示されること
- 51文字の名前: 「あ」を51回繰り返し
  → エラーメッセージ「名前は50文字以内で入力してください」が表示されること

## 2. メールアドレスフィールドのテスト

### 正常系
- 標準的なメール: test@example.com
- サブドメイン付き: test@mail.example.com
- プラス記号付き: test+tag@example.com

### 異常系
- 空文字のまま送信
  → エラーメッセージ「メールアドレスは必須です」が表示されること
- @なし: testexample.com
  → エラーメッセージ「有効なメールアドレスを入力してください」
- @のみ: test@
  → エラーメッセージ「有効なメールアドレスを入力してください」
- ドメインなし: test@
  → エラーメッセージ「有効なメールアドレスを入力してください」

## 3. 年齢フィールドのテスト

### 境界値テスト
- 最小値の下: -1
  → エラーメッセージ「0以上の数値を入力してください」
- 最小値: 0
  → 正常に登録されること
- 最小値の上: 1
  → 正常に登録されること
- 最大値の下: 149
  → 正常に登録されること
- 最大値: 150
  → 正常に登録されること
- 最大値の上: 151
  → エラーメッセージ「150以下の数値を入力してください」

### 異常系
- 空文字のまま送信
  → エラーメッセージ「年齢は必須です」
- 小数点: 25.5
  → step="1"により小数点入力が制限されていること

## 4. 部署フィールドのテスト

- 未選択のまま送信
  → 「未設定」として登録されること
- 各選択肢を選択
  → 選択した部署名で登録されること

## 5. 統合テスト

- すべてのフィールドに有効な値を入力して送信
  → データがテーブルに正しく表示されること
- クリアボタンのテスト
  → すべてのフィールドが空になること

各テストケースで:
- エラーメッセージの表示タイミング
- エラーメッセージの内容
- フォーム送信の成否
を確認してください。

テストコードを生成し、実行結果をレポートしてください。
```

##### Playwright MCPへの指示（詳細版）

```
Playwright MCPを使用して、フォーム入力の境界値テストを実行してください。

URL: http://127.0.0.1:5500/sample-site/index.html

## テスト手順

### テスト1: 名前フィールド - 51文字入力
1. #name に「あ」を51回繰り返した文字列を入力
2. 200ms待機（バリデーションのトリガー待ち）
3. #nameError のテキストに「50文字以内」が含まれることを確認
4. スクリーンショットを取得

### テスト2: メールアドレス - 不正な形式
1. #email に「invalid」を入力
2. 300ms待機
3. #emailError のテキストに「有効なメールアドレス」が含まれることを確認
4. #email に「test@」を入力
5. 300ms待機
6. #emailError のテキストに「有効なメールアドレス」が含まれることを確認
7. スクリーンショットを取得

### テスト3: 年齢 - 境界値テスト
1. #age に「-1」を入力
2. 200ms待機
3. #ageError のテキストに「0以上」が含まれることを確認
4. #age に「0」を入力
5. 200ms待機
6. #ageError が空であることを確認
7. #age に「150」を入力
8. 200ms待機
9. #ageError が空であることを確認
10. #age に「151」を入力
11. 200ms待機
12. #ageError のテキストに「150以下」が含まれることを確認
13. スクリーンショットを取得

### テスト4: 正常な入力
1. #name に「テストユーザー」を入力
2. #email に「test@example.com」を入力
3. #age に「30」を入力
4. #department で「開発」を選択
5. #submitBtn をクリック
6. 500ms待機
7. #tableBody tr が1件あることを確認
8. 1行目の名前が「テストユーザー」であることを確認
9. スクリーンショットを取得

### テスト5: クリアボタン
1. #name に「テスト」を入力
2. #email に「test@example.com」を入力
3. #age に「25」を入力
4. #resetBtn をクリック
5. すべてのフィールドが空であることを確認

各ステップの結果を記録してください。
```

---

## 3. ページング機能テスト

### 3.1 ページ遷移の境界値

#### テスト観点

| テストケース | 初期状態 | 操作 | 期待結果 |
|------------|---------|------|---------|
| 最初のページ | 1ページ目 | 「最初へ」「前へ」ボタン | 無効化されている |
| 最後のページ | 3ページ目 | 「次へ」「最後へ」ボタン | 無効化されている |
| 中間ページ | 2ページ目 | すべてのボタン | 有効化されている |
| 次へ遷移 | 1ページ目 | 「次へ」クリック | 2ページ目に遷移 |
| データ連続性 | - | ページ移動 | データの欠落・重複なし |

#### MCPツールへの指示例

##### Playwright Agent Modeへの指示

```
【タスク】ページング機能の包括的なテストを実行してください

対象URL: http://127.0.0.1:5500/sample-site/index.html

前提条件: 50件のデータを追加（3ページ分）

テストケース:

## 1. ページングコントロールの表示確認
- 21件以上のデータがある場合にページングが表示されること
- ページ情報が「現在ページ / 総ページ数」の形式で表示されること

## 2. ボタンの有効/無効状態
- 1ページ目にいる時:
  - 「最初へ」「前へ」ボタンが無効（disabled）
  - 「次へ」「最後へ」ボタンが有効
- 最後のページにいる時:
  - 「次へ」「最後へ」ボタンが無効
  - 「最初へ」「前へ」ボタンが有効
- 中間ページにいる時:
  - すべてのボタンが有効

## 3. ページ遷移
- 「次へ」ボタンで次のページに移動できること
- 「前へ」ボタンで前のページに移動できること
- 「最初へ」ボタンで1ページ目に移動できること
- 「最後へ」ボタンで最終ページに移動できること

## 4. データの表示確認
- 1ページ目: No.1〜20のデータが表示される
- 2ページ目: No.21〜40のデータが表示される
- 3ページ目: No.41〜50のデータが表示される（10件）

## 5. データの連続性
- ページを移動してもデータの欠落がないこと
- 1ページ目の最後が「テストユーザー20」
- 2ページ目の最初が「テストユーザー21」
- データの重複がないこと

各テストケースを実装し、実行結果をレポートしてください。
```

---

## 4. 統合テストシナリオ

### 4.1 現実的な利用パターン

#### MCPツールへの指示例

```
【タスク】実際のユーザー操作を模倣した統合テストを実行してください

対象URL: http://127.0.0.1:5500/sample-site/index.html

シナリオ: 新規ユーザーが初めてシステムを使用する流れ

## ステップ1: 初期表示の確認
1. ページを開く
2. エンプティメッセージが表示されていることを確認
3. フォームが表示されていることを確認

## ステップ2: データ入力の試行錯誤（バリデーション確認）
1. 何も入力せずに「追加」ボタンをクリック
   → ブラウザのネイティブバリデーションが働くことを確認
2. 不正なメールアドレスを入力
   → エラーメッセージが表示されることを確認
3. 範囲外の年齢を入力
   → エラーメッセージが表示されることを確認

## ステップ3: 正常なデータ入力
1. 正しい形式でデータを5件入力
2. 各データがテーブルに表示されることを確認
3. 件数表示が正しいことを確認

## ステップ4: 境界値の確認
1. さらに15件追加（合計20件）
2. ページングが表示されないことを確認
3. さらに2件追加（合計22件）
4. ページングが表示されることを確認

## ステップ5: ページング操作
1. 各ページに移動してデータを確認
2. データの連続性を確認

## ステップ6: データ削除
1. 2ページ目のデータを削除
2. ページ情報が更新されることを確認
3. データが20件になったらページングが消えることを確認

各ステップでスクリーンショットとパフォーマンスメトリクスを取得してください。
```

---

## 5. 複数MCPツールの組み合わせ

### 5.1 統合的な検証アプローチ

#### 指示例

```
【複合タスク】3つのMCPツールを使用して、包括的な検証を行ってください

## フェーズ1: Playwright Agent Modeで探索とテスト生成
Playwright Agent Modeを使用して:
1. サンプルサイトを探索
2. 境界値テストとフォーム入力テストのテストケースを生成
3. テストコードを実行

## フェーズ2: Playwright MCPでクロスブラウザ検証
Playwright MCPを使用して:
1. Chromium、Firefox、WebKitで同じテストを実行
2. ブラウザ間の動作の違いを確認
3. 各ブラウザでのバリデーション動作を比較

## フェーズ3: Chrome DevTools MCPでパフォーマンス分析
Chrome DevTools MCPを使用して:
1. 各境界値でのパフォーマンスを測定
2. メモリ使用量の変化を追跡
3. レンダリング時間を比較

## 最終レポート
以下を含む統合レポートを作成:
- テスト実行結果サマリー
- 境界値での動作の正確性
- クロスブラウザ互換性
- パフォーマンス分析結果
- 発見された問題点と改善提案
```

---

## 6. 指示のポイント

### 6.1 効果的な指示の書き方

#### ✅ Good（良い指示）

```
Playwright Agent Modeを使用して、以下の境界値テストを実行してください:

1. データ20件の状態（ページング境界）
   - ページングが非表示であることを確認
   - テーブルに20行表示されることを確認

2. データ21件の状態（境界値超え）
   - ページングが表示されることを確認
   - ページ情報が「2 / 2」であることを確認
```

**理由:**
- 具体的なツール名を指定
- テストケースが明確
- 期待結果が詳細

#### ❌ Bad（悪い指示）

```
境界値をテストして
```

**理由:**
- どのツールを使うか不明
- どの境界値をテストするか不明確
- 期待結果が曖昧

### 6.2 指示に含めるべき要素

1. **使用するMCPツールの明示**
   - "Playwright Agent Modeを使用して"
   - "Chrome DevTools MCPで"

2. **対象URLの明記**
   - "http://127.0.0.1:5500/sample-site/index.html"

3. **前提条件（あれば）**
   - "50件のデータを追加した状態で"

4. **具体的な操作手順**
   - "フィールドに値を入力"
   - "ボタンをクリック"

5. **期待される結果**
   - "エラーメッセージが表示されること"
   - "ページングが表示されること"

6. **成果物**
   - "テストコードを生成"
   - "スクリーンショットを取得"
   - "レポートを作成"

---

## 7. よくある質問

### Q1: テストデータの準備はどうすればいい?

**A:** 指示の中で明示的に指定します。

```
前提条件として、以下のデータを準備してください:
- 名前: テストユーザー1〜50
- メール: user1@example.com〜user50@example.com
- 年齢: 20〜69（順番に）
- 部署: ローテーションで選択
```

### Q2: 複数の境界値を一度にテストできる?

**A:** できます。リスト形式で指定します。

```
以下の境界値でテストを実行してください:
- 0件、1件、19件、20件、21件、40件、41件

各境界値で:
1. ページング表示の有無
2. 件数表示
3. テーブル行数
を確認してください。
```

### Q3: エラーが発生した場合の対処は?

**A:** エラーハンドリングも指示に含めます。

```
各テストケースで:
- 成功した場合: 次のテストに進む
- 失敗した場合: スクリーンショットを取得し、エラー内容を記録
- タイムアウトの場合: リトライは2回まで
```

---

## 付録: セレクタ一覧

### フォーム要素
```javascript
#name           // 名前入力フィールド
#email          // メールアドレス入力フィールド
#age            // 年齢入力フィールド
#department     // 部署選択フィールド
#submitBtn      // 追加ボタン
#resetBtn       // クリアボタン
```

### エラーメッセージ
```javascript
#nameError      // 名前のエラーメッセージ
#emailError     // メールのエラーメッセージ
#ageError       // 年齢のエラーメッセージ
```

### テーブル
```javascript
#emptyMessage   // エンプティメッセージ
#tableContainer // テーブルコンテナ
#tableBody      // テーブルボディ
#tableBody tr   // テーブル行
#totalCount     // 件数表示
```

### ページング
```javascript
#pagination     // ページングコンテナ
#pageInfo       // ページ情報（例: "1 / 3"）
#firstPageBtn   // 最初へボタン
#prevPageBtn    // 前へボタン
#nextPageBtn    // 次へボタン
#lastPageBtn    // 最後へボタン
```

---

**作成日**: 2025年10月25日
**最終更新**: 2025年10月25日
